# üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å BioMorphX

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ-–º–µ—Ä—ã-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
2. [–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏](#–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è-–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
3. [–ó–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö](#–∑–∞—â–∏—Ç–∞-–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö)
4. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–ª—è-–ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
5. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
6. [–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–ø—Ä–æ–≤–µ—Ä–∫–∞-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Admin API**
‚úÖ –í—Å–µ `/api/admin/*` endpoints –∑–∞—â–∏—â–µ–Ω—ã Basic Auth  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `checkAdminAuth()` –≤ –∫–∞–∂–¥–æ–º endpoint  
‚úÖ Middleware (`middleware.ts`) –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∑–∞—â–∏—â–∞–µ—Ç –≤—Å–µ admin routes  

**–ó–∞—â–∏—â—ë–Ω–Ω—ã–µ endpoints:**
- `/api/admin/orders` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- `/api/admin/emails` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- `/api/admin/update-order-status` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
- `/api/admin/delete-order` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `/api/admin/send-email` - –æ—Ç–ø—Ä–∞–≤–∫–∞ email

### 2. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (XSS Protection)**
‚úÖ –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ email  
‚úÖ –§—É–Ω–∫—Ü–∏—è `sanitizeHtml()` –≤ `src/lib/auth.js` —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç HTML-—Ç–µ–≥–∏  

**–°–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- Email –∞–¥—Ä–µ—Å
- –¢–µ–ª–µ—Ñ–æ–Ω
- –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∑–∞–∫–∞–∑—É
- –°–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π —Ñ–æ—Ä–º—ã

### 3. **Rate Limiting**
‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP  
‚úÖ In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è (–¥–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Redis)  

**–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã:**
- **–ó–∞–∫–∞–∑—ã** (`/api/orders`): 20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å —Å –æ–¥–Ω–æ–≥–æ IP
- **–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞** (`/api/contact`): 15 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Å
- **–û–±—Ä–∞—Ç–Ω—ã–π –∑–≤–æ–Ω–æ–∫** (`/api/callback`): 15 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å

### 4. **Security Headers**
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `next.config.js`  

**–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:**
- `Strict-Transport-Security` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS
- `X-Frame-Options: SAMEORIGIN` - –∑–∞—â–∏—Ç–∞ –æ—Ç clickjacking
- `X-Content-Type-Options: nosniff` - –∑–∞—â–∏—Ç–∞ –æ—Ç MIME-sniffing
- `X-XSS-Protection: 1; mode=block` - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è XSS-–∑–∞—â–∏—Ç–∞ –±—Ä–∞—É–∑–µ—Ä–∞
- `Referrer-Policy: strict-origin-when-cross-origin` - –∫–æ–Ω—Ç—Ä–æ–ª—å referrer
- `Permissions-Policy` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–µ—Ä–µ/–º–∏–∫—Ä–æ—Ñ–æ–Ω—É/–≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
- `Content-Security-Policy` - –∑–∞—â–∏—Ç–∞ –æ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤

### 5. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email, —Ç–µ–ª–µ—Ñ–æ–Ω–∞  
‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π  

**–§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `src/lib/auth.js`:**
- `isValidEmail()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ email
- `isValidPhone()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `limitLength()` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫

---

## üîë –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞

1. **Middleware** (`middleware.ts`)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Basic Auth –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ `/admin/*`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `ADMIN_USER` –∏ `ADMIN_PASS`
   - –ü–µ—Ä–≤–∞—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã

2. **API Authorization** (–∫–∞–∂–¥—ã–π endpoint)
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–∞–∂–¥–æ–º `/api/admin/*` endpoint
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `checkAdminAuth()` –∏–∑ `src/lib/auth.js`
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞–¥—ë–∂–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `.env`

```env
# .env
ADMIN_USER=admin
ADMIN_PASS=–í–ê–®_–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_–ó–î–ï–°–¨
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é:**
- –ú–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤
- –í–∫–ª—é—á–∞–µ—Ç –∑–∞–≥–ª–∞–≤–Ω—ã–µ –∏ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã
- –í–∫–ª—é—á–∞–µ—Ç —Ü–∏—Ñ—Ä—ã
- –í–∫–ª—é—á–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã

**–ü—Ä–∏–º–µ—Ä —Å–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è:**  
`Zm9@kL3$pR7&nQ2!`

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/admin`
2. –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç Basic Auth (–≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ)
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç `ADMIN_USER` –∏ `ADMIN_PASS`
4. Middleware –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
5. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ API-–∑–∞–ø—Ä–æ—Å—ã –≤–∫–ª—é—á–∞—é—Ç Basic Auth header
6. –ö–∞–∂–¥—ã–π endpoint –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

---

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –•—Ä–∞–Ω—è—â–∏–µ—Å—è –¥–∞–Ω–Ω—ã–µ

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MySQL —Å–æ–¥–µ—Ä–∂–∏—Ç:**

1. **–¢–∞–±–ª–∏—Ü–∞ `orders`** (–∑–∞–∫–∞–∑—ã):
   - ID –∑–∞–∫–∞–∑–∞
   - Email –∫–ª–∏–µ–Ω—Ç–∞
   - –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
   - –¢–µ–ª–µ—Ñ–æ–Ω
   - –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏
   - –°—É–º–º–∞ –∑–∞–∫–∞–∑–∞
   - –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
   - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

2. **–¢–∞–±–ª–∏—Ü–∞ `order_items`** (—Ç–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ):
   - ID –∑–∞–∫–∞–∑–∞
   - –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
   - –¶–µ–Ω–∞

3. **–¢–∞–±–ª–∏—Ü–∞ `contact_emails`** (–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è):
   - –ò–º—è
   - Email
   - –¢–µ–ª–µ—Ñ–æ–Ω
   - –°–æ–æ–±—â–µ–Ω–∏–µ

### –ó–∞—â–∏—Ç–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã (–∑–∞—â–∏—Ç–∞ –æ—Ç SQL-injection)
- Connection pooling –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è credentials

**‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**

1. **–°–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å MySQL:**
   ```env
   DB_PASSWORD=–°–ª–æ–∂–Ω—ã–π–ü–∞—Ä–æ–ª—å123!@#
   ```

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î:**
   - –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —Å localhost –∏–ª–∏ IP —Å–µ—Ä–≤–µ—Ä–∞
   - –û—Ç–∫–ª—é—á–∏—Ç—å remote root –¥–æ—Å—Ç—É–ø
   - –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

3. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î:**
   ```sql
   -- –ü—Ä–∏–º–µ—Ä –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   ALTER TABLE orders MODIFY shipping_address VARBINARY(500);
   ```

4. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup —Ä–∞–∑ –≤ –¥–µ–Ω—å
   0 3 * * * mysqldump -u user -p password biomorphx > /backup/db_$(date +\%Y\%m\%d).sql
   ```

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ GDPR –∏ 152-–§–ó

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (—Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ)
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ (HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)

**–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- ‚ö†Ô∏è –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ü–î (–¥–æ–±–∞–≤–∏—Ç—å checkbox –Ω–∞ —Ñ–æ—Ä–º–∞—Ö)
- ‚ö†Ô∏è –ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–∞–ø—Ä–æ—Å—É)
- ‚ö†Ô∏è –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- ‚ö†Ô∏è –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –ü–î

---

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=localhost
DB_USER=biomorphx_user
DB_PASSWORD=–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_–ë–î
DB_NAME=biomorphx

# SMTP (–ø–æ—á—Ç–∞)
SMTP_HOST=smtp.yandex.ru
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=–≤–∞—à_email@yandex.ru
SMTP_PASS=–≤–∞—à_–ø–∞—Ä–æ–ª—å_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
SMTP_FROM=–≤–∞—à_email@yandex.ru
ORDER_EMAIL_TO=vladskaromnyy@gmail.com
CONTACT_EMAIL_TO=vladskaromnyy@gmail.com

# –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
ADMIN_USER=admin
ADMIN_PASS=–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨_–ê–î–ú–ò–ù–ê

# Production
NODE_ENV=production
```

### 2. HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û:** –°–∞–π—Ç –î–û–õ–ñ–ï–ù —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

**–ü–æ—á–µ–º—É:**
- Basic Auth –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–∞—Ä–æ–ª–∏ –≤ base64 (–ª–µ–≥–∫–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ HTTPS)
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º
- Security headers (HSTS) —Ç—Ä–µ–±—É—é—Ç HTTPS

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx —Å SSL:**

```nginx
server {
    listen 443 ssl http2;
    server_name biomorphx.ru www.biomorphx.ru;

    ssl_certificate /path/to/ssl/cert.pem;
    ssl_certificate_key /path/to/ssl/key.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}

# –†–µ–¥–∏—Ä–µ–∫—Ç HTTP -> HTTPS
server {
    listen 80;
    server_name biomorphx.ru www.biomorphx.ru;
    return 301 https://$server_name$request_uri;
}
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ SSL (Let's Encrypt):**

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d biomorphx.ru -d www.biomorphx.ru
sudo certbot renew --dry-run  # –¢–µ—Å—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

### 3. Firewall –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP (–¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞)
sudo ufw allow 443/tcp  # HTTPS
sudo ufw enable

# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ MySQL
sudo ufw deny 3306/tcp  # –ó–∞–∫—Ä—ã—Ç—å –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ MySQL
```

### 4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–µ—Ä–≤–µ—Ä—É

**–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Ubuntu
sudo apt install unattended-upgrades
sudo dpkg-reconfigure --priority=low unattended-upgrades
```

**Fail2Ban –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞:**
```bash
sudo apt install fail2ban
sudo systemctl enable fail2ban
sudo systemctl start fail2ban
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤:**
```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs biomorphx

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log

# –õ–æ–≥–∏ MySQL
tail -f /var/log/mysql/error.log
```

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –î–ª—è —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **Rate Limiting –Ω–∞ Production**
   - ‚ö†Ô∏è –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
   - –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ª–∏–º–∏—Ç—ã —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
   - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è production

   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis
   sudo apt install redis-server
   
   # –í package.json –¥–æ–±–∞–≤–∏—Ç—å:
   npm install ioredis
   ```

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –ü–î**
   - –°–æ–∑–¥–∞—Ç—å –ª–æ–≥ –≤—Å–µ—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ `/api/admin/*`
   - –•—Ä–∞–Ω–∏—Ç—å: IP, –≤—Ä–µ–º—è, endpoint, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
   - –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

3. **CSRF Protection**
   - –î–ª—è —Ñ–æ—Ä–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å CSRF —Ç–æ–∫–µ–Ω—ã
   - Next.js API routes –∏—Å–ø–æ–ª—å–∑—É—é—Ç SameSite cookies –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `csurf`

4. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î**
   ```javascript
   // –ü—Ä–∏–º–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞
   const crypto = require('crypto');
   const algorithm = 'aes-256-cbc';
   const key = process.env.ENCRYPTION_KEY;
   
   function encrypt(text) {
     const iv = crypto.randomBytes(16);
     const cipher = crypto.createCipheriv(algorithm, Buffer.from(key), iv);
     let encrypted = cipher.update(text);
     encrypted = Buffer.concat([encrypted, cipher.final()]);
     return iv.toString('hex') + ':' + encrypted.toString('hex');
   }
   ```

### –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm audit fix`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `npm audit` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ Git
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ strong passwords –≤–µ–∑–¥–µ
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- ‚úÖ –î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ë–î –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–¢–µ—Å—Ç 1: –î–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**
```bash
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 401 Unauthorized
curl -i https://biomorphx.ru/api/admin/orders
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 401 Unauthorized
{"error":"–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"}
```

**–¢–µ—Å—Ç 2: –î–æ—Å—Ç—É–ø —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**
```bash
curl -i -u wronguser:wrongpass https://biomorphx.ru/api/admin/orders
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 401 Unauthorized
{"error":"–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"}
```

**–¢–µ—Å—Ç 3: –î–æ—Å—Ç—É–ø —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**
```bash
curl -i -u admin:–í–ê–®_–ü–ê–†–û–õ–¨ https://biomorphx.ru/api/admin/orders
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
HTTP/1.1 200 OK
{"success":true,"orders":[...]}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Rate Limiting

**–¢–µ—Å—Ç: –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ –Ω–∞ –∑–∞–∫–∞–∑—ã**
```bash
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å 6 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥ (–ª–∏–º–∏—Ç: 5 –≤ —á–∞—Å)
for i in {1..6}; do
  curl -X POST https://biomorphx.ru/api/orders \
    -H "Content-Type: application/json" \
    -d '{"test":"data"}'
  echo "Request $i"
done
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ 6-–º –∑–∞–ø—Ä–æ—Å–µ:**
```
HTTP/1.1 429 Too Many Requests
Retry-After: 3600
{"error":"–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–∫–∞–∑–æ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.","retryAfter":3600}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ Security Headers

**–¢–µ—Å—Ç: –ù–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```bash
curl -I https://biomorphx.ru
```

**–î–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å:**
```
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Content-Security-Policy: default-src 'self'; ...
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTPS

**–û–Ω–ª–∞–π–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- [SSL Labs](https://www.ssllabs.com/ssltest/) - —Ç–µ—Å—Ç SSL/TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [Security Headers](https://securityheaders.com/) - –ø—Ä–æ–≤–µ—Ä–∫–∞ security headers
- [Mozilla Observatory](https://observatory.mozilla.org/) - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–¶–µ–ª—å:** –†–µ–π—Ç–∏–Ω–≥ A –∏–ª–∏ A+ –Ω–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
npm audit

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
npm audit fix

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–∞–∫–µ—Ç–æ–≤
npm outdated
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–æ–±—â–∏—Ç–µ –æ–± —ç—Ç–æ–º:

**Email:** vladskaromnyy@gmail.com  
**Telegram:** @biomorphx

**‚ö†Ô∏è –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö –ø—É–±–ª–∏—á–Ω–æ –¥–æ –∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è!**

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OWASP Top 10](https://owasp.org/www-project-top-ten/) - –æ—Å–Ω–æ–≤–Ω—ã–µ —É–≥—Ä–æ–∑—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [Next.js Security](https://nextjs.org/docs/going-to-production#security) - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [Node.js Security Best Practices](https://nodejs.org/en/docs/guides/security/)
- [152-–§–ó "–û –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"](https://pd.rkn.gov.ru/docs/)

---

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0.0

